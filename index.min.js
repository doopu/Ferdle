"use strict";var infoModal=document.getElementById("infoModal"),helpButton=document.getElementById("help"),shareButton=document.getElementById("share"),spanHelp=document.getElementsByClassName("close-help")[0],keyboardDiv=document.getElementById("keyboard"),answerDiv=document.getElementById("answer"),postGameDiv=document.getElementById("postGame"),shareDiv=document.getElementById("shareBox"),twitterButton=document.getElementById("twitterShare"),discordButton=document.getElementById("discordShare");let vh=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${vh}px`);let seed=776;function random(){var e=1e4*Math.sin(seed++);return e-Math.floor(e)}function shuffle(e){let t,A=e.length;for(;0!=A;)t=Math.floor(random()*A),A--,[e[A],e[t]]=[e[t],e[A]];return e}const words=["ABYSS","ADEPT","ADRAH","AEGIR","AEGIS","AENIR","AESHA","AGONY","ALDER","ALGOL","ALICE","ALOIS","ALPEA","ALTAR","ALTEA","AMITI","ANIMA","AQQAR","ARDEN","ARDRI","ARENA","ARETE","ARION","ARLEN","ARMOR","ARRAN","ARTUR","ARVIS","ASBEL","ASSAL","ASTRA","ASUGI","ATHOL","ATHOS","ATLAS","AURUM","AVOID","AZAMA","AZMUR","AZURA","BADGE","BADON","BALDR","BALOR","BANBA","BANTU","BARAN","BARDS","BARON","BARST","BARTH","BARTS","BATON","BATTA","BAZBA","BEAST","BENNY","BERAN","BINKS","BIRDS","BLACK","BLADE","BLAKE","BLAZE","BLOOM","BOIES","BONDS","BOOTS","BORGO","BOVIS","BOYCE","BRADY","BRAGI","BRAND","BRAWL","BREAD","BRIAN","BRIDE","BROOK","BROOM","BRUNO","BRYCE","BRZAK","BUCKS","BYRON","CAEDA","CAMUS","CANAS","CANIS","CANTO","CARDS","CATCH","CECIL","CHAOS","CHARM","CHEST","CHEVE","CHILD","CHILL","CHROM","CIRCE","CLAIR","CLASS","CLAUD","CLAWS","CLIVE","CLUBS","CODDA","CODHA","COHEN","COINS","COLHO","CORAL","CREST","CROWN","CYRIL","DACIA","DAEIN","DAGDA","DAGON","DAHNA","DAISY","DALEN","DAMAS","DANCE","DARIN","DAUNT","DAYAN","DEATH","DECOY","DEDUE","DEMON","DEVIL","DIECK","DODGE","DOLHR","DOLPH","DOLTH","DOZEL","DOZLA","DRACO","DRAUG","DREAD","DRINK","DROPS","DRUID","DRYAS","DULAM","DWYER","EAGLE","EDAIN","EFFIE","EIBEL","EITRI","ELENA","ELIBE","ELICE","ELISE","ELITE","EMBER","ENTEH","EQUUS","ERITZ","ETZEL","EUGEN","EVADE","EVANS","EXPEL","FANGS","FATES","FAYRE","FEINT","FELIX","FEROX","FIANA","FIEND","FIGHT","FIONA","FIORA","FJORM","FLAER","FLAME","FLARE","FLASH","FLAYN","FLEET","FLORA","FLOUR","FOCUS","FOILS","FORDE","FORGE","FOTLA","FRANZ","FRAUS","FREYR","FROST","FRUIT","FUNKE","FURIA","GAIUS","GALLE","GARON","GAROU","GARTH","GAZAK","GECKO","GEESE","GEITZ","GENNY","GEORG","GERIK","GHARN","GLADE","GLARE","GLASS","GLENN","GOLEM","GOMER","GOMEZ","GORAN","GOTOH","GRADO","GRAVE","GREIL","GRIEF","GRIMA","GRUST","GUARD","GYGES","GYRAL","HADES","HAGAR","HAIKU","HALVE","HANON","HEATH","HEAVY","HENRY","HERBS","HERON","HICKS","HILDA","HOLST","HOMER","HONEY","HORSE","HREST","HRIST","HYMAN","IDEAL","IDUNN","IGNIS","IKONA","ILIOS","IMBUE","INDRA","INIGO","INNES","ITEMS","IZANA","IZUKA","IZUMO","JAGEN","JAKOB","JAMKE","JAROD","JARTH","JEDAH","JERME","JESSE","JINYA","JORGE","JUDAH","JUDGE","JULIA","KABUL","KADEN","KAFTI","KAMUI","KAREL","KARIN","KARLA","KATAR","KATRI","KATTI","KEMPF","KILMA","KLEIN","KLIFF","KLIMT","KNOLL","KOHGA","KUKRI","KURTH","LADLE","LAGUZ","LAHNA","LAMIA","LANCE","LARGO","LARUM","LAURA","LAYLA","LEILA","LEPUS","LETHE","LEVEL","LEVIN","LEWYN","LIBRA","LIFIS","LIGHT","LINDA","LINDE","LINUS","LIONS","LISSA","LLOYD","LOBOS","LONQU","LOPTR","LORDS","LOWEN","LUCIA","LUKAS","LUMEL","LUNGE","LYCIA","LYKKE","LYRIA","MABEL","MACES","MAERA","MAGIC","MAIKO","MALIG","MANNU","MARAJ","MARCH","MARCO","MARIA","MARLA","MARTH","MARTY","MEDAL","MELEE","MERCY","MIDIA","MIDIR","MIGAL","MINTZ","MISHA","MONKE","MOORE","MORSE","MORVA","MULAN","MUSAR","MYCEN","MYRRH","MYSON","NADER","NADOS","NANNA","NASIR","NEIMI","NEVKA","NIAMH","NIHIL","NIIME","NILES","NINJA","NOBLE","NOIRE","NOLAN","NOMAD","NOMAH","NORNE","NOTRE","NOVIS","NUDGE","OATES","OATHS","OBORO","OGHMA","OGIER","OIFEY","OLWEN","OMOZU","ORSON","ORTON","OSCAR","OSIAN","OSKAR","OSTIA","OSWIN","OWAIN","PABLO","PALLA","PANIC","PANNE","PAPER","PATTY","PEARL","PEONY","PERCY","PERES","PERNE","PETRA","PHILA","PHINA","PILUM","PIVOT","POWER","PRIAM","PRIDE","PRIMA","PUPIL","PURGE","PUZON","QUEEN","RAGNA","RAIGH","RAIMI","RAITH","RALLY","RAMAN","RAMON","RANDY","RAVEN","RAZIA","REESE","REGIA","REINA","RELIC","RENEE","REPEL","RIDER","RIGEL","RINEA","RINGS","RISYL","ROARK","ROBIN","RODAN","ROGER","ROGUE","RONAN","ROWAN","RUBEN","RUFUS","RUGER","RUMEI","RUNAN","RUNES","RYOMA","SABER","SABLE","SACAE","SAGES","SAIAS","SAINT","SAIZO","SALEH","SALEM","SASHA","SAUIN","SAYRI","SCOTT","SEALS","SENNO","SERRA","SHINE","SHION","SHIPS","SHIRO","SHIVA","SHOPS","SHOTS","SHOVE","SHURA","SIENE","SIGHT","SILAS","SIMIA","SIMON","SITRI","SKADI","SKILL","SKULD","SLEET","SLEUF","SMITE","SMOKE","SOLON","SONIA","SONYA","SOREN","SOTHE","SPEAR","SPEED","SPURN","SRENG","STAFF","STAHL","STARS","STEAL","STEEL","STICK","STONE","SULLY","SUMIA","SURTR","SWARM","SWEET","SWORD","SYLGR","TAHRA","TAKSH","TALON","TALYS","TANIA","TANYA","TARAS","TARBA","TERIN","THANI","THIEF","THRIA","THRUD","TIANA","TIGER","TITAN","TOBIN","TOKYO","TOMAS","TOMES","TONIC","TORUS","TRADE","TRAIT","TURNS","UMONO","UNITS","UNITY","URVAN","UTHER","UZUME","VAIDA","VAIKE","VALLA","VALNI","VALOR","VASTO","VERNA","VOLKE","VOLUG","VOUGE","WALLS","WALTZ","WARDS","WASTE","WATCH","WATER","WAVES","WHITE","WIGHT","WINGS","WITCH","WOLFF","WOODS","WOOTZ","WORDE","WRATH","YARNE","YASHA","YAZAM","YNGVI","YODEL","YODER","ZAGAM","ZAGAN","ZANTH","ZEISS","ZELOT","ZHARA","ZOFIA","ZONTA"];shuffle(words),shuffle(words),shuffle(words),shuffle(words);const answer=words[todaysIndex()],canvas=document.getElementById("mainCanvas"),ctx=canvas.getContext("2d");document.onselectstart=function(){return!1};const boxWidth=60;function drawBox(e,t,A="rgba(0, 0, 0, 1)",n){if(ctx){ctx.lineCap="butt",ctx.lineJoin="miter",ctx.strokeStyle="rgba(128, 128, 128, 1.0)",ctx.fillStyle=A,ctx.lineWidth=1,ctx.beginPath(),ctx.rect(e,t,60,60),ctx.stroke(),ctx.fill(),ctx.font="32px sans-serif",ctx.textAlign="center",ctx.fillStyle="rgba(0, 0, 0, 1)";const E=e+30,a=t+30+10;ctx.fillText(n,E,a)}}class GameState{constructor(){this.date=new Date,this.guesses=[],this.currentRow=0,this.gameOver=!1,this.win="X",this.colours=[],this.letterMap=new Map}saveState(){window.localStorage.setItem("ferdleState",JSON.stringify(this)),window.localStorage.setItem("ferdleLetterMap",JSON.stringify(Array.from(gameState.letterMap.entries())))}loadState(){if(window.localStorage.getItem("ferdleState")){let e=JSON.parse(window.localStorage.getItem("ferdleState")),t=new GameState;if(t.date=new Date(e.date),t.guesses=e.guesses,t.currentRow=e.currentRow,t.gameOver=e.gameOver,t.win=e.win,e.colours)t.colours=e.colours;else for(let e of t.guesses)t.colours.push(colour(e,!1));return window.localStorage.getItem("ferdleLetterMap")?t.letterMap=new Map(JSON.parse(window.localStorage.getItem("ferdleLetterMap"))):t.letterMap=new Map,t}return new GameState}}let gameState=(new GameState).loadState();function gameOver(){if(gameState.gameOver){shareButton.style.display="block",shareDiv.style.display="block",postGameDiv.style.display="block";let e="";e="X"!==gameState.win?"Congratulations, you got it! See you tomorrow!":"Oops, not this time!<br/>The word was: "+answer+".<br/>See you tomorrow!",answerDiv.innerHTML=e,answerDiv.style.display="block",keyboardDiv.style.display="none"}}function stateCheck(){gameState.date.getDate()!==(new Date).getDate()&&(gameState.date=new Date,gameState.guesses=[],gameState.currentRow=0,gameState.gameOver=!1,gameState.win="X",gameState.colours=[],gameState.letterMap=new Map),gameState.gameOver&&gameOver()}let currentGuess="";function colour(e,t){let A=[],n=[];for(let e=0;e<5;e++)t?A.push("white"):A.push("rgb(200, 200, 200)");if(t)return A;let E="",a="";for(let t=0;t<5;t++)answer[t]===e[t]?(A[t]="rgb(135, 224, 151)",E+=" ",a+=" ",n.push(t)):(E+=answer[t],a+=e[t]);let o=new Map;for(let e=0;e<a.length;e++){let t=E.split("").filter((t=>t===a[e])).length;o.set(a[e],t)}for(let e=0;e<a.length;e++)E.includes(a[e])&&" "!==a[e]&&o.get(a[e])>0&&(o.set(a[e],o.get(a[e])-1),A[e]="yellow");return A}function drawGame(){let e=(canvas.width-320)/2,t=(canvas.height-390)/2;for(let A=0;A<6;A++)for(let n=0;n<5;n++){let E="",a="white";gameState.colours.length>A&&(a=gameState.colours[A][n]),A<gameState.currentRow&&(E=gameState.guesses[A][n]),A===gameState.currentRow&&currentGuess[n]&&(E=currentGuess[n]),drawBox(e+60*n+5*n,t+60*A+5*A,a,E)}}function resize(){let e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`),canvas.height=canvas.offsetHeight,canvas.width=canvas.offsetWidth,drawScreen()}function drawScreen(){document.getElementById("header"),document.getElementById("footer");ctx&&ctx.clearRect(0,0,canvas.width,canvas.height),drawGame(),updateKeyboardColours()}function updateKeyboardColours(){for(const[e,t]of gameState.letterMap.entries()){const A=document.getElementById(e);A&&(A.style.backgroundColor=t)}}function submitGuess(){if(5===currentGuess.length)if(currentGuess=currentGuess.toUpperCase(),words.includes(currentGuess))logGuess(currentGuess);else{var e=document.getElementById("snackbar");e.innerHTML="Invalid word.",e.className="show",setTimeout((function(){e.className=e.className.replace("show","")}),3e3)}}function updateLetterMap(e,t){for(let A=0;A<e.length;A++){let n=t[A],E="white";gameState.letterMap.has(e[A])&&(E=gameState.letterMap.get(e[A])),"rgb(135, 224, 151)"!==E&&(("yellow"!==E||"rgb(135, 224, 151)"===n)&&gameState.letterMap.set(e[A],n))}}function logGuess(e){gameState.guesses.push(e),gameState.colours.push(colour(e,!1)),updateLetterMap(e,colour(e,!1)),gameState.currentRow+=1,currentGuess="",e===answer&&(gameState.win=gameState.currentRow+""),(e===answer||gameState.currentRow>5)&&(gameState.gameOver=!0,gameOver()),gameState.saveState()}function todaysIndex(){const e=new Date(2022,1,3),t=new Date;t.setHours(0,0,0,0);return Math.round(Math.abs((+e-+t)/864e5))}function processInput(e){gameState.gameOver||(e>64&&e<91&&currentGuess.length<5&&(currentGuess+=String.fromCharCode(e)),8!==e&&46!=e||currentGuess.length>0&&(currentGuess=currentGuess.substring(0,currentGuess.length-1)),13===e&&submitGuess()),drawScreen()}function inputEvent(e){e.repeat||processInput(e.keyCode)}function clickEvent(e){e.preventDefault();const t=e.target;t&&t.id&&("enter"===t.id?processInput(13):"delete"===t.id?processInput(8):1===t.id.length&&processInput(t.id.charCodeAt(0)))}function copyResult(e){let t="SOL KATTI BETA "+gameState.win+"/6 \n";for(let A of gameState.guesses){let n=colour(A,!1);for(let e of n)"rgb(200, 200, 200)"===e&&(t+="⬛"),"yellow"===e&&(t+="🟨"),"rgb(135, 224, 151)"===e&&(t+="🟩");e&&(t+="  ||`"+A+"`||"),t+="\n"}t+="\nhttps://doopu.github.io/solkatti/",navigator.clipboard.writeText(t).then((function(){console.log("Copy successful!")}),(function(e){console.error("Copy failed...",e)}))}function copyButton(e=!1){var t=document.getElementById("snackbar");t.innerHTML="Result copied to clipboard!",t.className="show",setTimeout((function(){t.className=t.className.replace("show","")}),3e3),copyResult(e)}window.addEventListener("resize",resize),window.addEventListener("keydown",inputEvent),keyboardDiv.addEventListener("click",clickEvent),stateCheck(),resize(),shareButton.onclick=function(){copyButton(!1)},twitterButton.onclick=function(){copyButton(!1)},discordButton.onclick=function(){copyButton(!0)},helpButton.onclick=function(){infoModal.style.display="block"},spanHelp.addEventListener("click",(function(){infoModal.style.display="none"})),window.onclick=function(e){e.target==infoModal&&(infoModal.style.display="none")};
