"use strict";var infoModal=document.getElementById("infoModal"),helpButton=document.getElementById("help"),shareButton=document.getElementById("share"),spanHelp=document.getElementsByClassName("close-help")[0],keyboardDiv=document.getElementById("keyboard"),answerDiv=document.getElementById("answer"),postGameDiv=document.getElementById("postGame"),shareDiv=document.getElementById("shareBox"),twitterButton=document.getElementById("twitterShare"),discordButton=document.getElementById("discordShare");let vh=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${vh}px`);let seed=776;function random(){var e=1e4*Math.sin(seed++);return e-Math.floor(e)}function shuffle(e){let t,A=e.length;for(;0!=A;)t=Math.floor(random()*A),A--,[e[A],e[t]]=[e[t],e[A]];return e}const words=["BARAN","KATRI","HENRY","NOMAH","BANTU","SOREN","SIMIA","TRADE","JAMKE","CHEVE","ALTEA","CHILD","TAHRA","BEAST","LUCIA","PANIC","JUDGE","GOLEM","MARCH","GREIL","BANBA","ARVIS","THIEF","ELIBE","FLARE","DAHNA","MERCY","SHINE","OSTIA","LAHNA","WIGHT","PRIAM","RUGER","CHEST","SITRI","SHIRO","TOMES","URVAN","MALIG","MAERA","SHIPS","GLARE","BARDS","PALLA","LAGUZ","FLAME","BADGE","MIGAL","ORSON","BERAN","BATTA","RAMAN","UTHER","SAUIN","FLASH","KAFTI","MANNU","GERIK","BRUNO","VALOR","OIFEY","NUDGE","GAZAK","EIBEL","BRAVE","SMOKE","CARDS","BALDR","BLACK","BARTH","LLOYD","RAIGH","PANNE","REPEL","JEDAH","EAGLE","BRADY","LISSA","ENTEH","CHILL","SYLGR","GHARN","CLAUD","DEDUE","SHURA","AESHA","CREST","RIDER","BARTS","GOMEZ","BRIDE","FRUIT","NORNE","OSKAR","FIORA","NIHIL","CLAWS","THRIA","STAFF","STEAL","TIANA","FAYRE","ZANTH","SULLY","MELEE","SHOTS","ARENA","ZEISS","KATTI","OSCAR","SIMON","SLEUF","SLEET","JORGE","KEMPF","DECOY","SAYRI","JAGEN","MORSE","FEROX","LORDS","JUDAH","HONEY","RUFUS","BINKS","WATCH","PRIMA","LAURA","GYRAL","ALDER","MAIKO","BALOR","ASBEL","STAHL","SAIAS","GORAN","RINEA","TANIA","WOODS","THRUD","HYMAN","GARON","LINUS","SABLE","HREST","NADOS","ARMOR","WORDE","OSIAN","DAGDA","INDRA","KAMUI","HADES","DEATH","BRZAK","AENIR","CHAOS","GEESE","DAYAN","DRYAS","KATAR","FOTLA","ATHOL","DREAD","SAINT","SALEH","CANAS","HAIKU","SWARM","LEVIN","SAIZO","RAGNA","DANCE","ROARK","WAVES","FLOUR","NOBLE","AEGIS","MULAN","AGNEA","MYSON","RUNAN","TERIN","BLOOM","LEWYN","ARDEN","BARON","YODEL","YARNE","SMITE","CLASS","LIFIS","RINGS","DOLTH","BLADE","AMITI","IDUNN","LETHE","AURUM","GAIUS","MARLA","SIGHT","ALPEA","ELITE","ARION","HEATH","NASIR","VASTO","VAIKE","FLORA","TOBIN","AZAMA","HILDA","DRACO","SOTHE","AGONY","GARTH","RONAN","GOTOH","TARBA","HERBS","PUZON","OGIER","RODAN","ASTRA","GRADO","DOZLA","MARTY","GEORG","NOMAD","CLIVE","REESE","EQUUS","SONIA","IZUMO","BONDS","BARST","FIONA","JAROD","KLIMT","DAUNT","BADON","MYCEN","NEIMI","POWER","CANIS","FOILS","FEINT","HOLST","MORVA","MISHA","MUSAR","SRENG","ALTAR","EVADE","BLAZE","FORDE","ZELOT","LOPTR","DOLHR","RUBEN","QUEEN","DACIA","TALYS","PIVOT","GRAVE","ERITZ","OATES","HEAVY","KARLA","STARS","LYRIA","LAMIA","SUMIA","EFFIE","AVOID","LAYLA","SERRA","STEEL","THANI","HRIST","SOLON","COINS","MIDIA","NANNA","WATER","CLAIR","ASUGI","FURIA","TAKSH","MINTZ","DARIN","SWORD","FANGS","UNITS","WASTE","MAGIC","FREYR","IGNIS","PURGE","SPEED","RUNES","LANCE","FATES","SENNO","DAGON","EMBLA","NILES","LEPUS","EUGEN","KNOLL","HICKS","BOIES","VOLUG","DAMAS","MACES","ILIOS","PEONY","YAZAM","ABYSS","WINGS","SCOTT","PRIDE","PETRA","LOBOS","KADEN","BRIAN","DAISY","ZHARA","LADLE","BYRON","ARLEN","RAVEN","LONQU","SABER","STICK","KURTH","COLHO","GEITZ","ROWAN","ATHOS","DRAUG","HORSE","OWAIN","WRATH","OGHMA","GECKO","BRYCE","TALON","ROGUE","MONKE","SHADE","BUCKS","FOCUS","MARAJ","RANDY","DOZEL","LYKKE","AZMUR","SILAS","CORAL","RAITH","NIAMH","JERME","NOLAN","LIBRA","HANON","MOORE","TARAS","ADRAH","GUARD","WHITE","SACAE","PERCY","INIGO","SURTR","TOKYO","SKILL","LUKAS","SKADI","JARTH","PEARL","SPURN","GYGES","STONE","NINJA","PERES","ORTON","DRINK","LINDE","OSWIN","PABLO","BIRDS","DRUID","FIEND","SHOVE","NOTRE","JESSE","KABUL","KUKRI","YNGVI","SWEET","RELIC","ARRAN","EDAIN","TURNS","RAMON","KIRAN","DWYER","PAPER","CHROM","ZAGAM","BRAGI","CAEDA","VOLKE","ARTUR","BORGO","AZURA","AQQAR","TITAN","GOMER","LUMEL","VERNA","GAROU","SPEAR","NOVIS","FLAER","BOYCE","GRIMA","YASHA","CECIL","MARTH","KLEIN","SKULD","OLWEN","EVANS","DODGE","ARDRI","RIGEL","RALLY","LUNGE","COHEN","KAREL","BOVIS","ALICE","GENNY","LINDA","FJORM","SHOPS","ZAGAN","REGIA","ALGOL","CATCH","RISYL","CIRCE","DIECK","IKONA","WARDS","UMONO","BRAND","GLASS","FRANZ","CODHA","OBORO","CLUBS","HERON","GRUST","CHARM","ATLAS","VAIDA","ELICE","FLEET","MEDAL","SAGES","KNIFE","DAEIN","ANIMA","SHIVA","BENNY","VALLA","ITEMS","RYOMA","IMBUE","BATON","FIGHT","ELISE","KARIN","PHILA","VOUGE","WALLS","IDEAL","AEGIR","HAGAR","ELENA","BAZBA","SASHA","EMBER","DROPS","LARGO","RENEE","VALNI","BROOM","ETZEL","LYCIA","PERNE","MYRRH","CAMUS","HOMER","JULIA","JAKOB","KILMA","BOOTS","TORUS","MARIA","NOIRE","WALTZ","ASSAL","SALEM","MIDIR","WOLFF","LOWEN","BLAKE","IZANA","RUMEI","SIENE","LEVEL","ALOIS","LARUM","WITCH","FLAYN","OATHS","DULAM","BRAWL","GLENN","BREAD","NIIME","INNES","ARETE","ZOFIA","PHINA","FRAUS","CYRIL","CODDA","TANYA","GALLE","DEVIL","UZUME","HALVE","PATTY","RAZIA","TIGER","SEALS","GRIEF","MABEL","IZUKA","NADER","TOMAS","FUNKE","EITRI","PILUM","CANTO","NEVKA","WOOTZ","CROWN","DALEN","ROGER","FELIX","LIGHT","FORGE","FROST","JINYA","MARCO","ZONTA","LIONS","SONYA","TRAIT","RAIMI","GLADE","KLIFF","DEMON","YODER","UNITY","DOLPH","KIRIA","ROBIN","TONIC","REINA","MAGES","SHION","EXPEL","PUPIL","LEILA","ADEPT","KOHGA","OMOZU","FIANA","BROOK"],answer=words[todaysIndex()],canvas=document.getElementById("mainCanvas"),ctx=canvas.getContext("2d");document.onselectstart=function(){return!1};const boxWidth=60;function drawBox(e,t,A="rgba(0, 0, 0, 1)",n){if(ctx){ctx.lineCap="butt",ctx.lineJoin="miter",ctx.strokeStyle="rgba(128, 128, 128, 1.0)",ctx.fillStyle=A,ctx.lineWidth=1,ctx.beginPath(),ctx.rect(e,t,60,60),ctx.stroke(),ctx.fill(),ctx.font="32px sans-serif",ctx.textAlign="center",ctx.fillStyle="rgba(0, 0, 0, 1)";const E=e+30,a=t+30+10;ctx.fillText(n,E,a)}}class GameState{constructor(){this.date=new Date,this.round=todaysIndex(),this.guesses=[],this.currentRow=0,this.gameOver=!1,this.win="X",this.colours=[],this.letterMap=new Map}saveState(){window.localStorage.setItem("ferdleState",JSON.stringify(this)),window.localStorage.setItem("ferdleLetterMap",JSON.stringify(Array.from(gameState.letterMap.entries())))}loadState(){if(window.localStorage.getItem("ferdleState")){let e=JSON.parse(window.localStorage.getItem("ferdleState")),t=new GameState;if(t.date=new Date(e.date),t.guesses=e.guesses,t.currentRow=e.currentRow,t.gameOver=e.gameOver,t.win=e.win,e.round?t.round=e.round:t.round=todaysIndex(),e.colours)t.colours=e.colours;else for(let e of t.guesses)t.colours.push(colour(e,!1));return window.localStorage.getItem("ferdleLetterMap")?t.letterMap=new Map(JSON.parse(window.localStorage.getItem("ferdleLetterMap"))):t.letterMap=new Map,t}return new GameState}}let gameState=(new GameState).loadState();function gameOver(){if(gameState.gameOver){shareButton.style.display="block",shareDiv.style.display="block",postGameDiv.style.display="block";let e="";e="X"!==gameState.win?"Congratulations, you got it! See you tomorrow!":"Oops, not this time!<br/>The word was: "+answer+".<br/>See you tomorrow!",answerDiv.innerHTML=e,answerDiv.style.display="block",keyboardDiv.style.display="none"}}function stateCheck(){gameState.date.getDate()!==(new Date).getDate()&&(gameState.date=new Date,gameState.round=todaysIndex(),gameState.guesses=[],gameState.currentRow=0,gameState.gameOver=!1,gameState.win="X",gameState.colours=[],gameState.letterMap=new Map),gameState.gameOver&&gameOver()}let currentGuess="";function colour(e,t){let A=[],n=[];for(let e=0;e<5;e++)t?A.push("white"):A.push("rgb(200, 200, 200)");if(t)return A;let E="",a="";for(let t=0;t<5;t++)answer[t]===e[t]?(A[t]="rgb(135, 224, 151)",E+=" ",a+=" ",n.push(t)):(E+=answer[t],a+=e[t]);let o=new Map;for(let e=0;e<a.length;e++){let t=E.split("").filter((t=>t===a[e])).length;o.set(a[e],t)}for(let e=0;e<a.length;e++)E.includes(a[e])&&" "!==a[e]&&o.get(a[e])>0&&(o.set(a[e],o.get(a[e])-1),A[e]="yellow");return A}function drawGame(){let e=(canvas.width-320)/2,t=(canvas.height-390)/2;for(let A=0;A<6;A++)for(let n=0;n<5;n++){let E="",a="white";gameState.colours.length>A&&(a=gameState.colours[A][n]),A<gameState.currentRow&&(E=gameState.guesses[A][n]),A===gameState.currentRow&&currentGuess[n]&&(E=currentGuess[n]),drawBox(e+60*n+5*n,t+60*A+5*A,a,E)}}function resize(){let e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`),canvas.height=canvas.offsetHeight,canvas.width=canvas.offsetWidth,drawScreen()}function drawScreen(){document.getElementById("header"),document.getElementById("footer");ctx&&ctx.clearRect(0,0,canvas.width,canvas.height),drawGame(),updateKeyboardColours()}function updateKeyboardColours(){for(const[e,t]of gameState.letterMap.entries()){const A=document.getElementById(e);A&&(A.style.backgroundColor=t)}}function submitGuess(){if(5===currentGuess.length)if(currentGuess=currentGuess.toUpperCase(),words.includes(currentGuess))logGuess(currentGuess);else{var e=document.getElementById("snackbar");e.innerHTML="Invalid word.",e.className="show",setTimeout((function(){e.className=e.className.replace("show","")}),3e3)}}function updateLetterMap(e,t){for(let A=0;A<e.length;A++){let n=t[A],E="white";gameState.letterMap.has(e[A])&&(E=gameState.letterMap.get(e[A])),"rgb(135, 224, 151)"!==E&&(("yellow"!==E||"rgb(135, 224, 151)"===n)&&gameState.letterMap.set(e[A],n))}}function logGuess(e){gameState.guesses.push(e),gameState.colours.push(colour(e,!1)),updateLetterMap(e,colour(e,!1)),gameState.currentRow+=1,currentGuess="",e===answer&&(gameState.win=gameState.currentRow+""),(e===answer||gameState.currentRow>5)&&(gameState.gameOver=!0,gameOver()),gameState.saveState()}function todaysIndex(){const e=new Date(Date.UTC(2022,1,5,0,0,0)),t=new Date;t.setUTCHours(0,0,0,0);return Math.round(Math.abs((+e-+t)/864e5))}function processInput(e){gameState.gameOver||(e>64&&e<91&&currentGuess.length<5&&(currentGuess+=String.fromCharCode(e)),8!==e&&46!=e||currentGuess.length>0&&(currentGuess=currentGuess.substring(0,currentGuess.length-1)),13===e&&submitGuess()),drawScreen()}function inputEvent(e){e.repeat||processInput(e.keyCode)}function clickEvent(e){e.preventDefault();const t=e.target;t&&t.id&&("enter"===t.id?processInput(13):"delete"===t.id?processInput(8):1===t.id.length&&processInput(t.id.charCodeAt(0)))}function copyResult(e){let t="SOL KATTI #"+(gameState.round+1)+" "+gameState.win+"/6 \n";for(let A of gameState.guesses){let n=colour(A,!1);for(let e of n)"rgb(200, 200, 200)"===e&&(t+="⬛"),"yellow"===e&&(t+="🟨"),"rgb(135, 224, 151)"===e&&(t+="🟩");e&&(t+="  ||`"+A+"`||"),t+="\n"}t+="\nhttps://doopu.github.io/solkatti/",navigator.clipboard.writeText(t).then((function(){console.log("Copy successful!")}),(function(e){console.error("Copy failed...",e)}))}function copyButton(e=!1){var t=document.getElementById("snackbar");t.innerHTML="Result copied to clipboard!",t.className="show",setTimeout((function(){t.className=t.className.replace("show","")}),3e3),copyResult(e)}window.addEventListener("resize",resize),window.addEventListener("keydown",inputEvent),keyboardDiv.addEventListener("click",clickEvent),stateCheck(),resize(),shareButton.onclick=function(){copyButton(!1)},twitterButton.onclick=function(){copyButton(!1)},discordButton.onclick=function(){copyButton(!0)},helpButton.onclick=function(){infoModal.style.display="block"},spanHelp.addEventListener("click",(function(){infoModal.style.display="none"})),window.onclick=function(e){e.target==infoModal&&(infoModal.style.display="none")};
